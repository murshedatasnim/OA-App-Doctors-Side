<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor-side view</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<body>
    <h1 class="m-2">Osteoarthritis Status</h1>
    <div>
        <div class="container mt-3">
            <h2>User Profile Table</h2>
            <table class="table table-dark">
                <caption style="text-align: left;">Table : User Profiles</caption>
                <thead>
                    <th>SL</th>
                    <th>UID</th>
                    <th>PID</th>
                    <th>Phone Number</th>
                </thead>
                <tbody id="tbody1"></tbody>
            </table>
        </div>

        <div class="container mt-3">
            <h2>User KOOS</h2>
            <table class="table table-dark">
                <caption style="text-align: left;">Table : User KOOS</caption>
                <thead>
                    <th>SL</th>
                    <th>Date</th>
                    <th>UID</th>
                    <th>KOOS</th>
                </thead>
                <tbody id="tbody2"></tbody>
            </table>
        </div>


        <div class="container mt-3">
            <h2>User Clinical Information</h2>
            <table class="table table-dark">
                <caption style="text-align: left;">Table : User Clinical Information</caption>
                <thead>
                    <th>SL</th>
                    <th>UID</th>
                    <th>Height in Meter</th>
                    <th>Weight in KG</th>
                    <th>Waist Circumferene in Inches</th>
                    <th>Is Knee Pain?</th>
                    <th>Affected Knee</th>
                    <th>Symptoms</th>
                    <th>Is Pain in Other Joints?</th>
                    <th>Other Joints Having Pain</th>
                    <th>Is Any Chronic Illness?</th>
                    <th>Chronic Illnesses</th>
                    <th>Menstrual History (For Female)</th>
                    <th>Is Smoker?</th>
                    <th>Cigarettes Per Day</th>
                    <th>Is Alcoholic?</th>
                    <th>Alcohol Intake Frequency</th>
                    <th>Sports Activity</th>
                    <th>Is Any Recent Injury?</th>
                    <th>Recent Injury</th>
                </thead>
                <tbody id="tbody3"></tbody>
            </table>
        </div>


        <div class="container mt-3">
            <h2>User Socio-demographic Information</h2>
            <table class="table table-dark">
                <caption style="text-align: left;">Table : User Socio-demographic Information</caption>
                <thead>
                    <th>SL</th>
                    <th>UID</th>
                    <th>Occupation</th>
                    <th>Work Association</th>
                    <th>House Type</th>
                    <th>Floor No.</th>
                    <th>Frequent Use of Staircases</th>
                    <th>House Toilet Type</th>
                    <th>Prayer Position</th>
                    
                </thead>
                <tbody id="tbody4"></tbody>
            </table>
        </div>


        <script type="module">
            // filling the table 1
            var userNo = 0;
            var tbody = document.getElementById('tbody1');

            var sl = 0;
            var tbody2 = document.getElementById('tbody2');

            var sl2 = 0;
            var tbody3 = document.getElementById('tbody3');

            var sl3 = 0;
            var tbody4  = document.getElementById('tbody4');

            function AddItemToTableProfile(uid, pid, phone) {
                let trow = document.createElement("tr");
                let td1 = document.createElement('td');
                let td2 = document.createElement('td');
                let td3 = document.createElement('td');
                let td4 = document.createElement('td');


                //table 1
                td1.innerHTML = ++userNo;
                td2.innerHTML = uid;
                td3.innerHTML = pid;
                td4.innerHTML = phone;

                trow.appendChild(td1);
                trow.appendChild(td2);
                trow.appendChild(td3);
                trow.appendChild(td4);

                tbody.appendChild(trow);


                
            }


            function AddItemToTableKoos(date, uid, koos) {
                
                let trow2 = document.createElement('tr');
                let td21 = document.createElement('td');
                let td22 = document.createElement('td');
                let td23 = document.createElement('td');
                let td24 = document.createElement('td');


                // table 2
                td21.innerHTML = ++sl;
                td22.innerHTML = date;
                td23.innerHTML = uid;
                td24.innerHTML = koos;

                trow2.appendChild(td21);
                trow2.appendChild(td22);
                trow2.appendChild(td23);
                trow2.appendChild(td24);

                tbody2.appendChild(trow2);


                
            }

            function AddItemToTableClinicalInfo(uid,
                        height, weight, waist_circumference, isKneePain, affectedKnee, symptoms, isPainInOtherJoints, otherJointsHavingPain,
                        isChronicIllness, chronicIllnesses, menstrualHistory, isSmoker, sticksPerDay, isAlcoholic, alcoholIntakeFrequency, sportsActivity,
                        isAnyRecentInjury, recentInjury) {
                
                let trow = document.createElement('tr');
                let td1 = document.createElement('td');
                let td2 = document.createElement('td');
                let td3 = document.createElement('td');
                let td4 = document.createElement('td');
                let td5 = document.createElement('td');
                let td6 = document.createElement('td');
                let td7 = document.createElement('td');
                let td8 = document.createElement('td');
                let td9 = document.createElement('td');
                let td10 = document.createElement('td');
                let td11 = document.createElement('td');
                let td12 = document.createElement('td');
                let td13 = document.createElement('td');
                let td14 = document.createElement('td');
                let td15 = document.createElement('td');
                let td16 = document.createElement('td');
                let td17 = document.createElement('td');
                let td18 = document.createElement('td');
                let td19 = document.createElement('td');
                let td20 = document.createElement('td');


                // table 2
                td1.innerHTML = ++sl2;
                td2.innerHTML = uid;
                td3.innerHTML = height;
                td4.innerHTML = weight;
                td5.innerHTML = waist_circumference;
                td6.innerHTML = isKneePain;
                td7.innerHTML = affectedKnee;
                td8.innerHTML = symptoms;
                td9.innerHTML = isPainInOtherJoints;
                td10.innerHTML = otherJointsHavingPain;
                td11.innerHTML = isChronicIllness;
                td12.innerHTML = chronicIllnesses;
                td13.innerHTML = menstrualHistory;
                td14.innerHTML = isSmoker;
                td15.innerHTML = sticksPerDay;
                td16.innerHTML = isAlcoholic;
                td17.innerHTML = alcoholIntakeFrequency;
                td18.innerHTML = sportsActivity;
                td19.innerHTML = isAnyRecentInjury;
                td20.innerHTML = recentInjury;
                

                trow.appendChild(td1);
                trow.appendChild(td2);
                trow.appendChild(td3);
                trow.appendChild(td4);
                trow.appendChild(td5);
                trow.appendChild(td6);
                trow.appendChild(td7);
                trow.appendChild(td8);
                trow.appendChild(td9);
                trow.appendChild(td10);
                trow.appendChild(td11);
                trow.appendChild(td12);
                trow.appendChild(td13);
                trow.appendChild(td14);
                trow.appendChild(td15);
                trow.appendChild(td16);
                trow.appendChild(td17);
                trow.appendChild(td18);
                trow.appendChild(td19);
                trow.appendChild(td20);

                tbody3.appendChild(trow);


                
            }


            function AddItemToTableSocioDemographicInfo(uid,
                        occupation, workAssociation, houseType, floor, frequentUseOfStaircase,
                        houseToiletType, prayerPosition) {
                
                let trow = document.createElement('tr');
                let td1 = document.createElement('td');
                let td2 = document.createElement('td');
                let td3 = document.createElement('td');
                let td4 = document.createElement('td');
                let td5 = document.createElement('td');
                let td6 = document.createElement('td');
                let td7 = document.createElement('td');
                let td8 = document.createElement('td');
                let td9 = document.createElement('td');


                // table 2
                td1.innerHTML = ++sl3;
                td2.innerHTML = uid;
                td3.innerHTML = occupation;
                td4.innerHTML = workAssociation;
                td5.innerHTML = houseType;
                td6.innerHTML = floor;
                td7.innerHTML = frequentUseOfStaircase;
                td8.innerHTML = houseToiletType;
                td9.innerHTML = prayerPosition;
                

                trow.appendChild(td1);
                trow.appendChild(td2);
                trow.appendChild(td3);
                trow.appendChild(td4);
                trow.appendChild(td5);
                trow.appendChild(td6);
                trow.appendChild(td7);
                trow.appendChild(td8);
                trow.appendChild(td9);

                tbody4.appendChild(trow);


                
            }

            function AddAllItemToTableProfile(User) {
                userNo = 0;
                tbody.innerHTML = "";
                User.forEach(element => {
                    AddItemToTableProfile(element.uid, element.pid, element.phone);
                });
            }

            function AddAllItemToTableKoos(Koos) {
                sl = 0;
                tbody2.innerHTML = "";
                Koos.forEach(element => {
                    AddItemToTableKoos(element.date, element.uid, element.koos);
                });
            }

            function AddAllItemToTableClinicalInfo(Koos) {
                sl2 = 0;
                tbody3.innerHTML = "";
                Koos.forEach(element => {
                    AddItemToTableClinicalInfo(element.uid,
                    element.height, element.weight, element.waist_circumference, element.isKneePain, element.affectedKnee, element.symptoms, element.isPainInOtherJoints, element.otherJointsHavingPain,
                    element.isChronicIllness, element.chronicIllnesses, element.menstrualHistory, element.isSmoker, element.sticksPerDay, element.isAlcoholic, element.alcoholIntakeFrequency, element.sportsActivity,
                    element.isAnyRecentInjury, element.recentInjury);
                });
            }

            function AddAllItemToTableSociodemographicInfo(Koos) {
                sl2 = 0;
                tbody3.innerHTML = "";
                Koos.forEach(element => {
                    AddItemToTableSocioDemographicInfo(element.uid,
                    element.occupation, element.workAssociation, element.houseType, element.floor, element.frequentUseOfStaircase,
                    element.houseToiletType, element.prayerPosition);
                });
            }

            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-analytics.js";
            import { getDatabase, ref, child, onValue, get }
                from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";

            const firebaseConfig = {
                apiKey: "AIzaSyCZPXtt8cGYIVGGctKd0fuWc9JXanU9EPg",
                authDomain: "osteoarthritis-7eb04.firebaseapp.com",
                databaseURL: "https://osteoarthritis-7eb04-default-rtdb.firebaseio.com",
                projectId: "osteoarthritis-7eb04",
                storageBucket: "osteoarthritis-7eb04.appspot.com",
                messagingSenderId: "428226813807",
                appId: "1:428226813807:web:cba703c1c61b8ac8d3929a",
                measurementId: "G-RYBWQCB9XE"
            };

            // Initialize Firebase

            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);

            const db = getDatabase();


            // get data

            // function GetAllDataOnce() {
            //     const dbRef = ref(db);
            //     get((child(dbRef, "profiles"))).then((snapshot) => {
            //         var users = [];
            //         console.log(snapshot);

            //         snapshot.forEach(childsnapshot => {
            //             users.push(childsnapshot.val());
            //         });

            //         AddAllItemToTable(users);
            //     });
            // }

            function GetAllDataRealTime() {
                const dbRef = ref(db, "profiles");

                onValue(dbRef, (snapshot) => {
                    var users = [];
                    snapshot.forEach(childsnapshot => {
                        users.push(childsnapshot.val());
                    });
                    // console.log(users);
                    AddAllItemToTableProfile(users);
                })

                const dbRef2 = ref(db, "koosScore");

                onValue(dbRef2, (snapshot) => {
                    var koos = [];
                    snapshot.forEach(childsnapshot => {
                        // koos.push(childsnapshot.val());
                        childsnapshot.forEach(shot=>{
                            koos.push(shot.val());
                        })
                    });
                    // console.log(koos[0]);
                    AddAllItemToTableKoos(koos);
                })


                const dbRef4 = ref(db, "socioDemographicInfos");

                onValue(dbRef4, (snapshot) => {
                    var socio = [];
                    snapshot.forEach(childsnapshot => {
                        socio.push(childsnapshot.val());
                    });
                    // console.log(koos[0]);
                    AddAllItemToTableSociodemographicInfo(socio);
                })

                const dbRef3 = ref(db, "clinicalInfos");

                onValue(dbRef3, (snapshot) => {
                    var clinical = [];
                    snapshot.forEach(childsnapshot => {
                        clinical.push(childsnapshot.val());
                    });
                    // console.log(koos[0]);
                    AddAllItemToTableClinicalInfo(clinical);
                })

                
            }
            window.onload = GetAllDataRealTime;
        </script>
    </div>


    
</body>

</html>